



				SELECT SUM(VIEW.QUANTITA) FROM
				(SELECT SUM (E.QTA_ORDINATA_ORIG) AS QUANTITA
				FROM TESTATA_ORDINE A, FRAZIONAMENTO B, BILL_OF_DISTR C, ITEM_HEADER D, LINEA_ORDINE E
				WHERE B.STATO_FRAZ = 'P' AND A.CORP_CODE = ? AND D.ITEM_NO = ? AND C.WH_SOURCE IN (
				SELECT BOD.WH_CODE FROM BILL_OF_DISTR BOD, ITEM_HEADER IH, WAREHOUSE_PD WP WHERE BOD.CORP_CODE = ? AND BOD.GL_VIRTUAL_WH_CODE = ?
				AND IH.ITEM_NO = ? AND WP.PD_CODE = ? AND BOD.CORP_CODE = IH.CORP_CODE AND BOD.CORP_CODE = WP.CORP_CODE
				AND BOD.BOD_CODE = IH.BOD_CODE AND WP.WH_CODE = BOD.WH_CODE)
				AND A.CORP_CODE = B.CORP_CODE AND A.CORP_CODE = C.CORP_CODE AND A.CORP_CODE = D.CORP_CODE
				AND A.CORP_CODE = E.CORP_CODE AND B.CORP_CODE = E.CORP_CODE AND A.COD_SOCIETA = B.COD_SOCIETA
				AND A.NUM_ORDINE = B.NUM_ORDINE AND B.COD_SOCIETA = E.COD_SOCIETA AND B.NUM_ORDINE = E.NUM_ORDINE
				AND B.NUM_LINEA_ORDINE = E.NUM_LINEA_ORDINE AND B.C_COD_PART = D.ITEM_NO AND C.BOD_CODE = D.BOD_CODE
				AND B.WH_CODE = C.WH_CODE
				UNION ALL
				SELECT SUM (E.QTA_ORDINATA_ORIG) AS QUANTITA
				FROM TESTATA_ORDINE_NAFTA A, FRAZIONAMENTO_NAFTA B, BILL_OF_DISTR C, ITEM_HEADER D, LINEA_ORDINE_NAFTA E
				WHERE B.STATO_FRAZ = 'P' AND A.CORP_CODE = ? AND D.ITEM_NO = ? AND C.WH_SOURCE IN (
				SELECT BOD.WH_CODE FROM BILL_OF_DISTR BOD, ITEM_HEADER IH, WAREHOUSE_PD WP WHERE BOD.CORP_CODE = ? AND BOD.GL_VIRTUAL_WH_CODE = ?
				AND IH.ITEM_NO = ? AND WP.PD_CODE = ? AND BOD.CORP_CODE = IH.CORP_CODE AND BOD.CORP_CODE = WP.CORP_CODE
				AND BOD.BOD_CODE = IH.BOD_CODE AND WP.WH_CODE = BOD.WH_CODE)
				AND A.CORP_CODE = B.CORP_CODE AND A.CORP_CODE = C.CORP_CODE AND A.CORP_CODE = D.CORP_CODE
				AND A.CORP_CODE = E.CORP_CODE AND B.CORP_CODE = E.CORP_CODE AND A.COD_SOCIETA = B.COD_SOCIETA
				AND A.NUM_ORDINE = B.NUM_ORDINE AND B.COD_SOCIETA = E.COD_SOCIETA AND B.NUM_ORDINE = E.NUM_ORDINE
				AND B.NUM_LINEA_ORDINE = E.NUM_LINEA_ORDINE AND B.C_COD_PART = D.ITEM_NO AND C.BOD_CODE = D.BOD_CODE
				AND B.WH_CODE = C.WH_CODE
				) AS VIEW
				WITH UR
				
				[1, 12                  , 1, 83, 12                  , 3, 1, 12                  , 1, 83, 12                  , 3]
				
	

getUrgentNormalLinesInfoGlobalPerPilotedPdCode	
				
loop -5 
SELECT GDP.ORDR_CLASS_CODE, count(*) FROM GLOBAL_ORD_DPL_TEMP GDP WHERE GDP.PROMISED_SHIP_DATE <= CURRENT DATE 
AND GDP.ITEM_NO = ? AND GDP.WH_CODE IN (SELECT DISTINCT BOD.WH_CODE FROM BILL_OF_DISTR BOD, ITEM_HEADER IH, WAREHOUSE_PD WP WHERE BOD.CORP_CODE = ? 
AND BOD.GL_VIRTUAL_WH_CODE = ? AND IH.ITEM_NO = ? AND WP.PD_CODE = ? AND BOD.CORP_CODE = IH.CORP_CODE 
AND BOD.CORP_CODE = WP.CORP_CODE AND BOD.BOD_CODE = IH.BOD_CODE AND WP.WH_CODE = BOD.WH_CODE) GROUP BY GDP.ORDR_CLASS_CODE WITH UR
[12                  , 1, 83, 12                  , 5]